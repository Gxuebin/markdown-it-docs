<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>开发者建议 | markdown-it</title>
    <meta name="description" content="">
    <script src="/baidu.js"></script>
    
    <link rel="preload" href="/assets/css/0.styles.df02e2f7.css" as="style"><link rel="preload" href="/assets/js/app.1bef7cbc.js" as="script"><link rel="preload" href="/assets/js/12.2d713cad.js" as="script"><link rel="prefetch" href="/assets/js/6.4eeff016.js"><link rel="prefetch" href="/assets/js/2.cda51ec0.js"><link rel="prefetch" href="/assets/js/3.cc883815.js"><link rel="prefetch" href="/assets/js/4.acdcc3ae.js"><link rel="prefetch" href="/assets/js/5.979eee86.js"><link rel="prefetch" href="/assets/js/7.5e408746.js"><link rel="prefetch" href="/assets/js/8.ab938f28.js"><link rel="prefetch" href="/assets/js/9.6733365b.js"><link rel="prefetch" href="/assets/js/10.64f2914c.js"><link rel="prefetch" href="/assets/js/11.f3f1d5c5.js"><link rel="prefetch" href="/assets/js/13.b174fd2c.js"><link rel="prefetch" href="/assets/js/14.30e11e54.js">
    <link rel="stylesheet" href="/assets/css/0.styles.df02e2f7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">markdown-it</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/architecture.html" class="nav-link">架构</a></div><div class="nav-item"><a href="/development.html" class="nav-link router-link-exact-active router-link-active">开发者建议</a></div><div class="nav-item"><a href="/security.html" class="nav-link">安全</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/architecture.html" class="nav-link">架构</a></div><div class="nav-item"><a href="/development.html" class="nav-link router-link-exact-active router-link-active">开发者建议</a></div><div class="nav-item"><a href="/security.html" class="nav-link">安全</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>开发者建议</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/development.html#对插件的一般性考虑" class="sidebar-link">对插件的一般性考虑</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/development.html#npm-软件包的注释" class="sidebar-link">NPM 软件包的注释</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/development.html#faq" class="sidebar-link">FAQ</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="开发者建议"><a href="#开发者建议" aria-hidden="true" class="header-anchor">#</a> 开发者建议</h1> <p>在继续之前，确保你已经阅读：</p> <ol><li><a href="https://github.com/markdown-it/markdown-it#markdown-it" target="_blank" rel="noopener noreferrer">README<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="/" class="router-link-active">API 文档</a></li> <li><a href="/architecture.html">架构说明</a></li></ol> <h2 id="对插件的一般性考虑"><a href="#对插件的一般性考虑" aria-hidden="true" class="header-anchor">#</a> 对插件的一般性考虑</h2> <ol><li>尝试为插件规则找到正确的位置：</li></ol> <ul><li>它会与现有的标签（优先级）冲突吗？
<ul><li>如果是的话，你需要写一个内联或块规则。</li> <li>如果没有 - 你可以改变核心链中的 token。</li></ul></li> <li>记住，核心链中的 token 变换总是比编写更简单。
<ul><li><p>块或内联规则</p> <p>如果你不复制现有的规则。然而，块和内联规则通常更快。</p></li></ul></li> <li>有时，仅修改渲染器就足够了。例如，添加标题 ID 或给链接添加 <code>target=&quot;_blank&quot;</code>。</li> <li>插件不应该要求 <code>markdown-it</code> 包作为包 <code>package.json</code> 中的依赖项。
如果需要访问内部实体，则可以通过解析器实例获得这些信息，通过插件加载。请参考主类和嵌套对象的属性。</li></ul> <ol start="2"><li><p>搜索现有的插件
<a href="https://www.npmjs.org/browse/keyword/markdown-it-plugin" target="_blank" rel="noopener noreferrer">插件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>或<a href="https://github.com/markdown-it/markdown-it/tree/master/lib" target="_blank" rel="noopener noreferrer">规则<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>其实做类似的事情。修改现有代码可以更简单，而不是从头开始编写。</p></li> <li><p>如果你做了所有的步骤，但仍然有问题-问 <a href="https://github.com/markdown-it/markdown-it/issues" target="_blank" rel="noopener noreferrer">tracker<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。但是，请注意：</p> <ul><li>具体点。诸如“如何做插件”之类的通用问题，“如何学习编程”是不被待见的。</li> <li>不要要求我们打破 <a href="http://commonmark.org/" target="_blank" rel="noopener noreferrer">CommonMark<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 规范。
这样的事情应该首先在 <a href="http://talk.commonmark.org/" target="_blank" rel="noopener noreferrer">CommonMark 论坛<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 讨论。</li></ul></li></ol> <h2 id="npm-软件包的注释"><a href="#npm-软件包的注释" aria-hidden="true" class="header-anchor">#</a> NPM 软件包的注释</h2> <p>简化搜索：</p> <ul><li>给插件的 <code>package.json</code> 添加关键字 <code>markdown-it</code> 和 <code>markdown-it-plugin</code> 。</li> <li>为其他相关的包添加关键字 <code>markdown-it</code>。</li></ul> <h2 id="faq"><a href="#faq" aria-hidden="true" class="header-anchor">#</a> FAQ</h2> <h4 id="我需要一个异步规则，该怎么做？"><a href="#我需要一个异步规则，该怎么做？" aria-hidden="true" class="header-anchor">#</a> 我需要一个异步规则，该怎么做？</h4> <p>抱歉。你不能直接做这件事。所有复杂的解析器本质上是同步的。但是你可以使用如下解决方案：</p> <ol><li>在解析阶段，用随机数替换内容，并将其存储在 <code>env</code> 中。</li> <li>对收集的数据进行异步处理。</li> <li>渲染内容并用文本替换这些随机数字；或者替换第一个，然后渲染。</li></ol> <p>或者，你可以渲染成 HTML，然后将其解析为 DOM，抑或 <a href="https://github.com/cheeriojs/cheerio" target="_blank" rel="noopener noreferrer">cheerio<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> AST，并用更方便的方式应用转变。</p> <h4 id="如何用链接替换文本标记的一部分？"><a href="#如何用链接替换文本标记的一部分？" aria-hidden="true" class="header-anchor">#</a> 如何用链接替换文本标记的一部分？</h4> <p>正确的顺序是将文本拆分为几个 token 并在其间添加链接 token。</p> <p>结果将是：<code>text</code> + <code>link_open</code> + <code>text</code> + <code>link_close</code> + <code>text</code>。</p> <p>参考 <a href="https://github.com/markdown-it/markdown-it/blob/master/lib/rules_core/linkify.js" target="_blank" rel="noopener noreferrer">linkify<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 和 <a href="https://github.com/markdown-it/markdown-it-emoji/blob/master/lib/replace.js" target="_blank" rel="noopener noreferrer">emoji<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的实现- 它们执行文本 token 分割。</p> <p><strong>注意.</strong> 不要用 HTML 标签替换文本！那不安全。</p> <h4 id="为什么不执行我的内联规则？"><a href="#为什么不执行我的内联规则？" aria-hidden="true" class="header-anchor">#</a> 为什么不执行我的内联规则？</h4> <p>内联解析器跳过了文本片段以便优化速度。它只在<a href="https://github.com/markdown-it/markdown-it/blob/master/lib/rules_inline/text.js" target="_blank" rel="noopener noreferrer">一小组字符<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>上驻足，这可以是 tokens 。由于性能原因，我们没有将此列表扩展。</p> <p>如果你绝对确信那里缺少了重要的东西 - 创建一个 ticket，我们会考虑把它作为一个新的字符。</p> <h4 id="你为什么拒绝一些有用的东西？"><a href="#你为什么拒绝一些有用的东西？" aria-hidden="true" class="header-anchor">#</a> 你为什么拒绝一些有用的东西？</h4> <p>我们做的是一个 markdown 解析器。它应该保持“markdown 精神”。其他事情应该隔离。例如插件。抱歉，我们没有明确的标准。</p> <p>也许，你会发现 <a href="http://talk.commonmark.org/" target="_blank" rel="noopener noreferrer">CommonMark 论坛<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>是一个有用的读物，从而更好地理解我们。</p> <p>当然，如果你觉得对另一种标签的类型来说，这个解析器的架构你很感兴趣，欢迎你在另一个项目中重用它。</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/12.2d713cad.js" defer></script><script src="/assets/js/app.1bef7cbc.js" defer></script>
  </body>
</html>
